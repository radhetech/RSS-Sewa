<div class="row">
    <div class="col-sm-12" [formGroup]="adminForm">
      <app-card
        [hidHeader]="false"
        [cardTitle]="{ title: 'સેવા દર્શન 2024 -', description: '' }"
        [cardClass]="'card'"
        [headerClass]="'panel-header'"
      >
        <div class="was-validated font-16">
          <div class="row">
            <div class="mb-3 col-md-3 font-16">
                <div class="form-group" *ngIf="talukaList.length">
                    <label for="taluka" class="font-16">નગર/તાલુકો:</label>
                    <label for="vibhag" class="float-right font-16">કુલ-{{talukaList.length}}</label>
                    <select id="taluka" class="form-select" formControlName="taluka" (change)="talukaChange($event)">
                        <option value="" selected>પસંદ કરો</option>
                        <option *ngFor="let taluka of talukaList" [value]="taluka.talukaId">{{ taluka.talukaName }}
                        </option>
                    </select>
                </div>
              </div>
              <div class="mb-3 col-md-3 font-16">
                <div class="form-group">
                    <label for="vasti" class="font-16">સેવા વસ્તી:</label>
                    <label for="vibhag" class="float-right font-16 ">કુલ-{{vastiList.length}}</label>
                    <select id="vasti" class="form-select" formControlName="vasti" (change)="vastiChange($event)">
                        <option value="" selected>પસંદ કરો</option>
                        <option *ngFor="let vasti of vastiList" [value]="vasti.sevaVastiId">{{ vasti.sevaVastiName
                            }}</option>

                    </select>
                    
                </div>
              </div>
            <div class="mb-3 col-md-3 font-16">
              <label class="font-16">સેવા દર્શન કરવા જનાર </label>
              <input
                type="text"
                class="form-control ptb-7"
                formControlName="reportingPerson"
                placeholder="name"
              />
            </div>
          </div>
        </div>
      </app-card>
    </div>
  </div>
  
  <form *ngIf="dynamicForm" [formGroup]="dynamicForm" (ngSubmit)="onSubmit()">
    <div *ngFor="let item of keys; let i = index">
      <div [formGroupName]="item.category">
        <div ngbAccordion>
          <div ngbAccordionItem [collapsed]="true">
            <h2 ngbAccordionHeader>
              <button ngbAccordionButton>{{ item.catName }}</button>
            </h2>
            <div ngbAccordionCollapse>
              <div
                *ngFor="let subcategory of item.subcategories; let i = index"
                [formGroupName]="subcategory.name"
              >
                <div class="card mb-0 font-16">
                  <div class="card-header ptb-10" [ngClass]="i % 2 === 0 ? 'even' : 'odd'">
                    <a class="card-link">
                      {{ subcategory.label }}
                    </a>
                  </div>
                  <div class="card-body ptb-10">
                    <div class="row ptb-10">
                      <div class="col-md-4 mb-1">
                        <label for="">શરૂ થયાની તારીખ </label>
                        <input
                          type="date"
                          class="form-control"
                          formControlName="startDate"
                          placeholder="તારીખ"
                        />
                      </div>
                      <div class="col-md-4 mb-1">
                        <label for="">છબી ( 2 થી ઓછી ) </label>
                        <!-- <input type="number" class="form-control" formControlName="photos"
                                              placeholder="photos" />  -->
                        <input
                          type="file"
                          class="form-control"
                          formControlName="photos"
                          (change)="onFileSelected($event, subcategory, item)"
                        />
                      <div class="mt-2">
                        <div *ngFor="let photo of dynamicForm.get([item.category, subcategory.name, 'photos']).value" class="mb-1">
                          <p (click)="downloadPhoto(photo)"> {{photo}} </p>
                          <!-- <img [src]="photo" alt="Uploaded Photo" class="img-thumbnail" width="100" height="100" /> -->
                        </div>
                      </div>
                        <!-- <div class="mt-2">
                          <div *ngFor="let photo of dynamicForm?.controls[item]?.controls[subcategory]" class="mb-1">
                            <img [src]="photo" alt="Uploaded Photo" class="img-thumbnail" width="100" height="100" />
                          </div>
                        </div> -->
                      
  
                        <!-- <input type="file" id="myfile" formControlName="photos" class="form-control" name="myfile" multiple><br><br> -->
                      </div>
                      <div class="col-md-4 mb-1">
                        <label for="">નોંધ </label>
                        <textarea
                          class="form-control"
                          formControlName="note"
                          placeholder="નોંધ"
                        >
                        </textarea>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- <div *ngFor="let subcategory of item.subcategories" [formGroupName]="subcategory.name">
              <div class="card mb-0">
                  <div class="card-header">
                      <a class="card-link" >
                          {{ subcategory.label }}
                      </a>
                    
                  </div>
                
                </div>
              </div> -->
            </div>
          </div>
        </div>
      </div>
    </div>
    <button type="submit" class="btn btn-primary submit-btn font-16">
      <i class="feather icon-thumbs-up"></i>
      Submit
    </button>
  </form>
  <app-snackbar
    [errorsmsg]="msg"
    [snackbarColour]="snackbarColour"
    *ngIf="showSnackBar"
  ></app-snackbar>
  
 